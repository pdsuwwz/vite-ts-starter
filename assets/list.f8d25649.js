import{e as f,v as j,h as $,_ as p,r,o as m,b as T,g as n,w as c,d as g,t as V,p as N,q as E,l as I,f as w,y,z as A,A as b,c as _,B,C as x,D as F,u as H,G as R,P as v,H as M}from"./index.280cbc92.js";import{N as U}from"./NavBar.0b750c0b.js";import D from"./ProjectForm.495aebf2.js";import q from"./TableHeader.2ed80a07.js";import z from"./TableBody.fa985df6.js";import{l as G}from"./lodash.99159cbb.js";import"./Translations.df3345af.js";import"./ProjectItem.efa04d2c.js";const K=f({name:"NavigationSideLogo",setup(){const e=j();return{title:$(()=>e.t("base.systemTitle"))}}}),J=""+new URL("vue.20be1948.svg",import.meta.url).href,O={class:"side-logo-container"},Q=(e=>(N("data-v-72e5dc05"),e=e(),E(),e))(()=>g("img",{class:"side-logo-img",src:J,alt:"\u5546\u6807"},null,-1)),W={class:"side-logo-title"},X=p(K,[["render",function(e,t,l,o,a,d){const s=r("router-link");return m(),T("div",O,[n(s,{to:`/${e.$route.params.locale||""}`},{default:c(()=>[Q,g("h1",W,V(e.title),1)]),_:1},8,["to"])])}],["__scopeId","data-v-72e5dc05"],["__file","/home/runner/work/vite-ts-starter/vite-ts-starter/src/components/Navigation/Side/SideLogo.vue"]]),Y=f({name:"SearchSelect",components:{Loading:I},props:{modelValue:{type:String,default:""},placeholder:{type:String,default:""},fetch:{type:Function,default:()=>()=>{}}},emits:["update:modelValue","change","select"],setup(e){const{proxy:t}=b(),l=w(!1),o=w("");return y(()=>e.modelValue,a=>{o.value=a},{immediate:!0}),y(()=>o,G.exports.debounce(function(a){t.$emit("update:modelValue",a),t.$emit("change",a)},300)),{loading:l,searchValue:o}},methods:{keydown(e){e.keyCode===229&&(e.returnValue=!1,e.stopPropagation()),e.keyCode===32&&(e.returnValue=!1)},getExecText:e=>e.replace(new RegExp(/(<([^>]+)>)/,"gi"),""),handleSelect({value:e}){this.$emit("select",e)},async handleSearch(e,t){const l=e.toLowerCase().replace(new RegExp(/[-[\]{}()*+?.,\\^$|#\s]/g),"\\$&");let o=[];if(!l)return void t(o);this.loading=!0,o=await this.fetch(l)||[],o.forEach(a=>{a.label=a.label.replace(new RegExp(l,"gi"),d=>`<span class="search-select-highlight">${d}</span>`)}),t(o),setTimeout(()=>{A(()=>{this.loading=!1})},200)}}}),Z=["title","innerHTML"],ee=f({name:"SearchCorporation",components:{SearchSelect:p(Y,[["render",function(e,t,l,o,a,d){const s=r("loading"),u=r("el-icon"),h=r("IconFont"),S=r("el-autocomplete");return m(),_(S,x({modelValue:e.searchValue,"onUpdate:modelValue":t[0]||(t[0]=i=>e.searchValue=i),modelModifiers:{trim:!0}},e.$attrs,{class:"search-input-container","popper-class":"search-select-container","trigger-on-focus":!1,"fetch-suggestions":e.handleSearch,placeholder:e.placeholder,onSelect:e.handleSelect,onKeydownCapture:t[1]||(t[1]=i=>e.keydown(i))}),B({default:c(({item:i})=>[g("span",{title:e.getExecText(i.label),innerHTML:i.label},null,8,Z)]),_:2},[e.loading?{name:"suffix",fn:c(()=>[n(u,{class:"search-loading-icon"},{default:c(()=>[n(s)]),_:1})])}:{name:"suffix",fn:c(()=>[g("i",{class:"search-icon"},[n(h,{icon:"iconsearch"})])])}]),1040,["modelValue","fetch-suggestions","placeholder","onSelect"])}],["__file","/home/runner/work/vite-ts-starter/vite-ts-starter/src/components/SearchSelect/index.vue"]])},emits:["select"],setup:()=>({searchValue:w("")}),methods:{handleFetchSearch:async e=>F.map(t=>({value:t,label:t})),handleSelectSearch(e){this.$emit("select",e)}}}),de=p(f({name:"ProjectList",components:{NavigationNavBar:U,NavigationSideLogo:X,ProjectTableHeader:q,ProjectTableBody:z,SearchCorporation:p(ee,[["render",function(e,t,l,o,a,d){const s=r("SearchSelect");return m(),_(s,x({modelValue:e.searchValue,"onUpdate:modelValue":t[0]||(t[0]=u=>e.searchValue=u),fetch:e.handleFetchSearch,placeholder:"\u641C\u7D22\u9879\u76EE","select-when-unmatched":"","highlight-first-item":""},e.$attrs,{onSelect:e.handleSelectSearch}),null,16,["modelValue","fetch","onSelect"])}],["__file","/home/runner/work/vite-ts-starter/vite-ts-starter/src/components/SearchSelect/SearchCorporation.vue"]])},setup(){const{proxy:e}=b(),t=H(),l=j();function o(a){t.dispatch(v.getAction("getProjectList"),{kw:a})}return o(),{localeInject:l,handleCreateProject:function(){const a=R({name:"",corpName:"",notes:""});e.$ModalDialog({title:l.t("project.create"),top:"10vh",width:"50vw","show-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,renderComponent:{data:a,component:D},async onConfirm(d,s){if(!await d.validateRules())return Promise.reject(new Error("error"));s.fullLoading=!0;const{error:u,data:h}=await t.dispatch(v.getAction("createProject"),a);if(s.fullLoading=!1,u)return Promise.reject(new Error("error"));t.dispatch(v.getAction("getProjectList"))}})},handleSelectSearch:o}}}),[["render",function(e,t,l,o,a,d){const s=r("NavigationSideLogo"),u=r("NavigationNavBar"),h=r("IconFont"),S=r("el-button"),i=r("LayoutSection"),L=r("SearchCorporation"),P=r("ProjectTableHeader"),C=r("ProjectTableBody"),k=r("LayoutArea");return m(),_(k,null,{top:c(()=>[n(u,{fixed:!1},{default:c(()=>[n(s)]),_:1})]),side:c(()=>[n(i,{title:e.localeInject.t("project.manageTitle")},{default:c(()=>[n(S,{type:"primary",class:"create-action",onClick:t[0]||(t[0]=te=>e.handleCreateProject())},{default:c(()=>[n(h,{icon:"iconestablish"}),M(" "+V(e._t("project.create")),1)]),_:1})]),_:1},8,["title"])]),content:c(()=>[n(i,{"has-divider":"","flex-content":""},{head:c(()=>[n(L,{onSelect:e.handleSelectSearch},null,8,["onSelect"])]),default:c(()=>[n(P),n(C)]),_:1})]),_:1})}],["__scopeId","data-v-94f0c0fb"],["__file","/home/runner/work/vite-ts-starter/vite-ts-starter/src/modules/Project/pages/list.vue"]]);export{de as default};
